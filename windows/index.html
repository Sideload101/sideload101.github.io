<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<title>Sideload101</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<style>
  :root { --bg: rgb(18,18,18); --panel: rgb(30,30,30); --panel2: rgb(25,25,25); --muted:#ccc; }
  html,body { height:100%; margin:0; padding:0; background:var(--bg); color:#fff; font-family: Helvetica, sans-serif; }
  #svg { width:100%; display:flex; justify-content:center; align-items:flex-start; padding-top:40px; box-sizing:border-box; overflow:hidden; }
  #svg svg { width:100%; height:auto; display:block; max-width: min(150vh, 150%); }

  @media (max-width:800px) {
    header { padding:20px; text-align:center; }
    header h1 { margin:0; font-size:24px; }
    header p { margin:5px 0 20px; font-size:16px; color:var(--muted); }

    .os-toggle { display:flex; justify-content:center; gap:10px; margin-bottom:10px; }
    .os-toggle button { background:var(--panel); border:0; color:#fff; padding:10px 16px; border-radius:6px; cursor:pointer; }
    .os-toggle button.active { background: rgb(70,70,70); }

    .sticky-buttons { position: sticky; top:0; z-index:20; display:flex; flex-direction:column; gap:8px; padding:6px 12px; background:var(--bg); }
    .toggle-btn { display:flex; align-items:center; justify-content:space-between; padding:14px 16px; background:var(--panel); border-radius:8px; border:0; color:#fff; font-size:16px; cursor:pointer; }
    .toggle-btn .arrow { font-size:18px; transition: transform .18s ease; }

    .content { max-height:0; overflow:hidden; transition: max-height .55s cubic-bezier(0.05,0.7,0.2,1); background:var(--panel2); border-radius:8px; margin:8px 0 12px; padding:0 16px; box-sizing:border-box; }
    .content.active { max-height:1400px; padding:16px; }
  }

  @media (min-width:801px) {
    header, .os-toggle, .sticky-buttons { display:none; }
  }

  .muted { color:var(--muted); font-size:14px; }
</style>
</head>
<body>
  <header>
    <h1>Sideload101</h1>
    <p class="muted">An ultimate sideloading guide</p>
  </header>

  <div class="os-toggle">
    <button id="macBtn" class="active" type="button">macOS</button>
    <button id="winBtn" type="button">Windows</button>
  </div>

  <div class="sticky-buttons">
    <button class="toggle-btn" data-target="trollstore" type="button">TrollStore <span class="arrow">&#9654;</span></button>
    <div class="content" id="trollstore" role="region" aria-hidden="true"></div>

    <button class="toggle-btn" data-target="altstore" type="button">AltStore/SideStore <span class="arrow">&#9654;</span></button>
    <div class="content" id="altstore" role="region" aria-hidden="true"></div>

    <button class="toggle-btn" data-target="sideloadly" type="button">Sideloadly <span class="arrow">&#9654;</span></button>
    <div class="content" id="sideloadly" role="region" aria-hidden="true"></div>
  </div>

  <div id="svg"></div>

<script>
(function(){
  const svgContainer = document.getElementById('svg');
  const isMobile = window.innerWidth <= 800;

  async function fetchToContainer(url, container) {
    try {
      const res = await fetch(url);
      if (!res.ok) throw new Error('Not found');
      container.innerHTML = await res.text();
    } catch (e) {
      container.innerHTML = '<p style="color:#bbb;margin:12px 0">Content unavailable: ' + url + '</p>';
      console.warn('Failed to fetch', url, e);
    }
  }

  // mobile OS toggle
  const macBtn = document.getElementById('macBtn');
  const winBtn = document.getElementById('winBtn');
  let currentOS = 'macos';

  if (macBtn && winBtn) {
    macBtn.addEventListener('click', () => {
      currentOS = 'macos';
      macBtn.classList.add('active'); winBtn.classList.remove('active');
      document.querySelectorAll('.content').forEach((c,i) => {
        if (c.classList.contains('active')) fetchToContainer(`${currentOS}-mobile-${i+1}.svg`, c);
      });
    });
    winBtn.addEventListener('click', () => {
      currentOS = 'windows';
      winBtn.classList.add('active'); macBtn.classList.remove('active');
      document.querySelectorAll('.content').forEach((c,i) => {
        if (c.classList.contains('active')) fetchToContainer(`${currentOS}-mobile-${i+1}.svg`, c);
      });
    });
  }

  // mobile toggles
  const toggles = document.querySelectorAll('.toggle-btn');
  toggles.forEach((btn, idx) => {
    btn.addEventListener('click', async () => {
      const targetId = btn.dataset.target;
      const content = document.getElementById(targetId);
      const isActive = content.classList.contains('active');

      document.querySelectorAll('.content').forEach(c => { c.classList.remove('active'); c.setAttribute('aria-hidden','true'); });
      toggles.forEach(t => { t.classList.remove('active'); t.querySelector('.arrow').innerHTML = '&#9654;'; });

      if (!isActive) {
        btn.classList.add('active');
        content.classList.add('active');
        content.setAttribute('aria-hidden','false');
        btn.querySelector('.arrow').innerHTML = '&#9660;';
        const index = idx + 1;
        await fetchToContainer(`${currentOS}-mobile-${index}.svg`, content);
      }
    });
  });

  // default loading
  if (isMobile) {
    // default: open first section with macos-mobile-1.svg
    const firstContent = document.getElementById('trollstore');
    if (firstContent) {
      firstContent.classList.add('active');
      document.querySelector('.toggle-btn')?.classList.add('active');
      document.querySelector('.toggle-btn .arrow')?.innerHTML = '&#9660;';
      fetchToContainer('macos-mobile-1.svg', firstContent);
    }
  } else {
    // desktop: UA-based detection
    const ua = navigator.userAgent.toLowerCase();
    let svgFile = 'windows.svg';
    if (ua.includes('windows')) svgFile = 'windows.svg';
    else if (ua.includes('macintosh') || ua.includes('mac os') || ua.includes('mac os x')) svgFile = 'macos.svg';
    else svgFile = 'windows.svg';
    fetchToContainer(svgFile, svgContainer);
  }
})();
</script>
</body>
</html>